store updates in a separate struct and swap structs over after an update to avoid partial updates

loan loss stats year on year
add remaining attachments to report email

Check email works
format reports

Fix the deployment - somehow micros are running out of space!